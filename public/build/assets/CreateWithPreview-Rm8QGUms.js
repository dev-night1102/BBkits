import{r as j,x as k,j as e,Q as E,S as R,V as c}from"./app-CcCqpfhZ.js";import{A as S}from"./AuthenticatedLayout-DjtgMhk1.js";import{I as s}from"./InputLabel-DGy5-P22.js";import{T as i}from"./TextInput-DM3fgFG3.js";import{P as _}from"./PrimaryButton-D9mRC_LM.js";import{S as b}from"./SecondaryButton-BwN-TPXz.js";import{M as q}from"./Modal-czVN_RE3.js";import"./transition-xVG7TShl.js";import"./dialog-gW7URlLt.js";function z(){const[g,m]=j.useState(!1),[o,y]=j.useState(null),{data:a,setData:r,post:f,processing:h,errors:u}=k({client_name:"",client_email:"",client_phone:"",client_cpf:"",child_name:"",embroidery_position:"",embroidery_color:"",embroidery_font:"",total_amount:"",shipping_amount:"",payment_method:"pix",received_amount:"",payment_date:"",payment_receipt:null,delivery_address:"",delivery_number:"",delivery_complement:"",delivery_neighborhood:"",delivery_city:"",delivery_state:"",delivery_zipcode:"",notes:"",preferred_delivery_date:""}),N=()=>{const t=[{field:"client_name",label:"Nome do Cliente"},{field:"client_phone",label:"Telefone"},{field:"child_name",label:"Nome da Criança"},{field:"embroidery_position",label:"Posição do Bordado"},{field:"embroidery_color",label:"Cor do Bordado"},{field:"total_amount",label:"Valor Total"},{field:"shipping_amount",label:"Valor do Frete"},{field:"received_amount",label:"Valor Recebido"},{field:"payment_date",label:"Data de Pagamento"},{field:"delivery_address",label:"Endereço de Entrega"},{field:"delivery_city",label:"Cidade"},{field:"delivery_state",label:"Estado"},{field:"delivery_zipcode",label:"CEP"}].filter(d=>!a[d.field]);return t.length>0?(t.forEach(d=>{c.error(`Campo obrigatório: ${d.label}`)}),!1):a.payment_receipt?!0:(c.error("Comprovante de pagamento é obrigatório"),!1)},C=l=>{l.preventDefault(),N()&&m(!0)},w=()=>{f(route("sales.store"),{onSuccess:()=>{c.success("🎉 Venda registrada com sucesso! Link do cliente gerado.")},onError:l=>{Object.keys(l).forEach(t=>{c.error(l[t])})}})},F=l=>{const t=l.target.files[0];if(t){r("payment_receipt",t);const d=new FileReader;d.onloadend=()=>{y(d.result)},d.readAsDataURL(t)}},n=l=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(l),x={pix:"🔗",boleto:"📄",cartao:"💳",dinheiro:"💰"},v={pix:"PIX",boleto:"Boleto Bancário",cartao:"Cartão de Crédito/Débito",dinheiro:"Dinheiro"},p={top:"Superior",bottom:"Inferior",left:"Esquerda",right:"Direita",center:"Centro"},P=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"];return e.jsxs(S,{header:e.jsx("h2",{className:"font-bold text-2xl text-gray-800 leading-tight",children:"📦 Registrar Nova Venda"}),children:[e.jsx(E,{title:"Registrar Venda"}),e.jsx("div",{className:"py-8",children:e.jsx("div",{className:"max-w-7xl mx-auto sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold mb-6 text-gray-800 border-b pb-3",children:"👤 Informações do Cliente"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"client_name",value:"Nome do Cliente *"}),e.jsx(i,{id:"client_name",value:a.client_name,onChange:l=>r("client_name",l.target.value),required:!0,className:"mt-1 block w-full"}),u.client_name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:u.client_name})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"client_email",value:"Email"}),e.jsx(i,{id:"client_email",type:"email",value:a.client_email,onChange:l=>r("client_email",l.target.value),className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"client_phone",value:"Telefone *"}),e.jsx(i,{id:"client_phone",value:a.client_phone,onChange:l=>r("client_phone",l.target.value),required:!0,className:"mt-1 block w-full"})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"client_cpf",value:"CPF"}),e.jsx(i,{id:"client_cpf",value:a.client_cpf,onChange:l=>r("client_cpf",l.target.value),className:"mt-1 block w-full"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold mb-6 text-gray-800 border-b pb-3",children:"🧵 Detalhes do Bordado"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"child_name",value:"Nome da Criança/Bebê *"}),e.jsx(i,{id:"child_name",value:a.child_name,onChange:l=>r("child_name",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"embroidery_position",value:"Posição do Bordado *"}),e.jsxs("select",{id:"embroidery_position",value:a.embroidery_position,onChange:l=>r("embroidery_position",l.target.value),required:!0,className:"mt-1 block w-full rounded-md border-gray-300",children:[e.jsx("option",{value:"",children:"Selecione..."}),Object.entries(p).map(([l,t])=>e.jsx("option",{value:l,children:t},l))]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"embroidery_color",value:"Cor do Bordado *"}),e.jsx(i,{id:"embroidery_color",value:a.embroidery_color,onChange:l=>r("embroidery_color",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"embroidery_font",value:"Fonte"}),e.jsx(i,{id:"embroidery_font",value:a.embroidery_font,onChange:l=>r("embroidery_font",l.target.value),className:"mt-1 block w-full"})]})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold mb-6 text-gray-800 border-b pb-3",children:"📍 Endereço de Entrega"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_zipcode",value:"CEP *"}),e.jsx(i,{id:"delivery_zipcode",value:a.delivery_zipcode,onChange:l=>r("delivery_zipcode",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsx(s,{htmlFor:"delivery_address",value:"Endereço *"}),e.jsx(i,{id:"delivery_address",value:a.delivery_address,onChange:l=>r("delivery_address",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_number",value:"Número"}),e.jsx(i,{id:"delivery_number",value:a.delivery_number,onChange:l=>r("delivery_number",l.target.value),className:"mt-1 block w-full"})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_complement",value:"Complemento"}),e.jsx(i,{id:"delivery_complement",value:a.delivery_complement,onChange:l=>r("delivery_complement",l.target.value),className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_neighborhood",value:"Bairro"}),e.jsx(i,{id:"delivery_neighborhood",value:a.delivery_neighborhood,onChange:l=>r("delivery_neighborhood",l.target.value),className:"mt-1 block w-full"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_city",value:"Cidade *"}),e.jsx(i,{id:"delivery_city",value:a.delivery_city,onChange:l=>r("delivery_city",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"delivery_state",value:"Estado *"}),e.jsxs("select",{id:"delivery_state",value:a.delivery_state,onChange:l=>r("delivery_state",l.target.value),required:!0,className:"mt-1 block w-full rounded-md border-gray-300",children:[e.jsx("option",{value:"",children:"Selecione..."}),P.map(l=>e.jsx("option",{value:l,children:l},l))]})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"preferred_delivery_date",value:"Data Preferencial de Entrega"}),e.jsx(i,{id:"preferred_delivery_date",type:"date",value:a.preferred_delivery_date,onChange:l=>r("preferred_delivery_date",l.target.value),className:"mt-1 block w-full"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-lg",children:[e.jsx("h3",{className:"text-xl font-bold mb-6 text-gray-800 border-b pb-3",children:"💰 Informações de Pagamento"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"payment_method",value:"Forma de Pagamento *"}),e.jsx("select",{id:"payment_method",value:a.payment_method,onChange:l=>r("payment_method",l.target.value),required:!0,className:"mt-1 block w-full rounded-md border-gray-300",children:Object.entries(v).map(([l,t])=>e.jsxs("option",{value:l,children:[x[l]," ",t]},l))})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx(s,{htmlFor:"total_amount",value:"Valor Total *"}),e.jsx(i,{id:"total_amount",type:"number",step:"0.01",value:a.total_amount,onChange:l=>r("total_amount",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"shipping_amount",value:"Frete *"}),e.jsx(i,{id:"shipping_amount",type:"number",step:"0.01",value:a.shipping_amount,onChange:l=>r("shipping_amount",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"received_amount",value:"Valor Recebido *"}),e.jsx(i,{id:"received_amount",type:"number",step:"0.01",value:a.received_amount,onChange:l=>r("received_amount",l.target.value),required:!0,className:"mt-1 block w-full"})]})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"payment_date",value:"Data do Pagamento *"}),e.jsx(i,{id:"payment_date",type:"date",value:a.payment_date,onChange:l=>r("payment_date",l.target.value),required:!0,className:"mt-1 block w-full"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"payment_receipt",value:"Comprovante de Pagamento *"}),e.jsx("input",{id:"payment_receipt",type:"file",onChange:F,accept:"image/*,application/pdf",required:!0,className:"mt-1 block w-full"}),o&&e.jsx("img",{src:o,alt:"Preview",className:"mt-2 h-32 object-contain rounded"})]}),e.jsxs("div",{children:[e.jsx(s,{htmlFor:"notes",value:"Observações"}),e.jsx("textarea",{id:"notes",value:a.notes,onChange:l=>r("notes",l.target.value),className:"mt-1 block w-full rounded-md border-gray-300",rows:"3"})]})]})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx(b,{type:"button",onClick:()=>R.visit(route("sales.index")),children:"Cancelar"}),e.jsx(_,{type:"submit",disabled:h,children:"📋 Visualizar Resumo"})]})]})})}),e.jsx(q,{show:g,onClose:()=>m(!1),maxWidth:"2xl",children:e.jsxs("div",{className:"p-6",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-gray-800",children:"📋 Resumo do Pedido"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"👤 Cliente"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nome:"})," ",a.client_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Telefone:"})," ",a.client_phone]}),a.client_email&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Email:"})," ",a.client_email]}),a.client_cpf&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"CPF:"})," ",a.client_cpf]})]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"🧵 Bordado"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Nome:"})," ",a.child_name]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Posição:"})," ",p[a.embroidery_position]]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Cor:"})," ",a.embroidery_color]}),a.embroidery_font&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Fonte:"})," ",a.embroidery_font]})]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"📍 Entrega"}),e.jsxs("div",{className:"text-sm",children:[e.jsxs("p",{children:[a.delivery_address,", ",a.delivery_number]}),a.delivery_complement&&e.jsx("p",{children:a.delivery_complement}),e.jsx("p",{children:a.delivery_neighborhood}),e.jsxs("p",{children:[a.delivery_city,"/",a.delivery_state," - CEP: ",a.delivery_zipcode]}),a.preferred_delivery_date&&e.jsxs("p",{className:"mt-2",children:[e.jsx("span",{className:"font-medium",children:"Data preferencial:"})," ",new Date(a.preferred_delivery_date).toLocaleDateString("pt-BR")]})]})]}),e.jsxs("div",{className:"border-b pb-4",children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"💰 Pagamento"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Método:"})," ",x[a.payment_method]," ",v[a.payment_method]]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Data:"})," ",new Date(a.payment_date).toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Valor Total:"})," ",n(a.total_amount)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Frete:"})," ",n(a.shipping_amount)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Valor Recebido:"})," ",n(a.received_amount)]}),parseFloat(a.received_amount)<parseFloat(a.total_amount)&&e.jsxs("div",{className:"col-span-2 text-orange-600",children:[e.jsx("span",{className:"font-medium",children:"Valor Restante:"})," ",n(a.total_amount-a.received_amount)]})]}),o&&e.jsxs("div",{className:"mt-3",children:[e.jsx("span",{className:"font-medium text-sm",children:"Comprovante:"}),e.jsx("img",{src:o,alt:"Comprovante",className:"mt-1 h-24 object-contain rounded border"})]})]}),a.notes&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-lg mb-2",children:"📝 Observações"}),e.jsx("p",{className:"text-sm text-gray-600",children:a.notes})]})]}),e.jsx("div",{className:"mt-8 bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:["⚠️ ",e.jsx("strong",{children:"Atenção:"})," Após confirmar, um link único será gerado para o cliente acompanhar o pedido."]})}),e.jsxs("div",{className:"mt-6 flex justify-end gap-4",children:[e.jsx(b,{onClick:()=>m(!1),children:"✏️ Editar"}),e.jsx(_,{onClick:w,disabled:h,children:"✅ Confirmar e Gerar Link do Cliente"})]})]})})]})}export{z as default};
