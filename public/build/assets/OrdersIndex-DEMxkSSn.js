import{r as p,x as $,j as e,Q as D,t as h,V as o}from"./app-D_WxyEEO.js";import{A as G}from"./AuthenticatedLayout-Cl6Fbj1d.js";import{f as d}from"./currency-Ct0iAvPU.js";import"./transition-kesi6X_i.js";function q({orders:l,statusFilter:i}){var E;const[s,b]=p.useState(null),[y,r]=p.useState(!1),[f,v]=p.useState("view"),[N,A]=p.useState(null),{data:m,setData:_,post:u,processing:x,errors:w,reset:L}=$({product_photo:null,notes:"",tracking_code:"",invoice_number:""}),S=t=>{b(t),v("view"),r(!0),L()},M=t=>{u(route("production.orders.start",t.id),{onSuccess:()=>{o.success("Produ√ß√£o iniciada com sucesso!"),r(!1),window.location.reload()},onError:a=>{console.error("Error starting production:",a),a.error?o.error(a.error):a.validation?o.error("Erro de valida√ß√£o: "+a.validation.join(", ")):o.error("Erro ao iniciar produ√ß√£o. Tente novamente.")},onStart:()=>{o.loading("Iniciando produ√ß√£o...")},onFinish:()=>{o.dismiss()}})},B=()=>{if(!m.product_photo){o.error("Por favor, selecione uma foto do produto");return}u(route("production.orders.upload-photo",s.id),{onSuccess:()=>{o.success("Foto enviada para aprova√ß√£o!"),r(!1)}})},R=()=>{u(route("production.orders.generate-shipping",s.id),{onSuccess:()=>{o.success("Etiqueta de envio gerada!"),r(!1)}})},T=t=>{const a=t.target.files[0];if(a){_("product_photo",a);const n=new FileReader;n.onloadend=()=>{A(n.result)},n.readAsDataURL(a)}},P=t=>{const a={payment_approved:"bg-green-100 text-green-800",in_production:"bg-blue-100 text-blue-800",photo_sent:"bg-purple-100 text-purple-800",ready_for_shipping:"bg-teal-100 text-teal-800",shipped:"bg-gray-100 text-gray-800"},n={payment_approved:"‚úÖ Pronto para Produ√ß√£o",in_production:"üè≠ Em Produ√ß√£o",photo_sent:"üì∏ Foto Enviada",ready_for_shipping:"üì¶ Pronto para Envio",shipped:"üöö Enviado"};return e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${a[t]}`,children:n[t]})},k=t=>{switch(t.order_status){case"payment_approved":return e.jsx("button",{onClick:a=>{a.stopPropagation(),M(t)},disabled:x,className:"bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-colors text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Processando...":"Iniciar Produ√ß√£o"});case"in_production":return e.jsx("button",{onClick:a=>{a.stopPropagation(),b(t),v("photo"),r(!0)},className:"bg-purple-500 text-white px-4 py-2 rounded-lg hover:bg-purple-600 transition-colors text-sm",children:"Enviar Foto"});case"ready_for_shipping":return e.jsx("button",{onClick:a=>{a.stopPropagation(),R()},className:"bg-teal-500 text-white px-4 py-2 rounded-lg hover:bg-teal-600 transition-colors text-sm",children:"Gerar Envio"});default:return null}},C=t=>{const a=parseFloat(t.total_amount)+parseFloat(t.shipping_amount||0),n=t.payments?t.payments.filter(j=>j.status==="approved").reduce((j,V)=>j+parseFloat(V.amount),0):parseFloat(t.received_amount||0),F=Math.max(0,a-n);return{totalAmount:a,paidAmount:n,remainingAmount:F,isFullyPaid:F<=0}},c=t=>new Date(t).toLocaleDateString("pt-BR"),g={payment_approved:l.filter(t=>t.order_status==="payment_approved").length,in_production:l.filter(t=>t.order_status==="in_production").length,photo_sent:l.filter(t=>t.order_status==="photo_sent").length,ready_for_shipping:l.filter(t=>t.order_status==="ready_for_shipping").length};return e.jsxs(e.Fragment,{children:[e.jsx(D,{title:"Gest√£o de Produ√ß√£o - Pedidos"}),e.jsxs(G,{header:e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"üè≠ Gest√£o de Produ√ß√£o"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Gerencie o processo de produ√ß√£o e envio dos pedidos"})]}),children:[e.jsx("div",{className:"py-12 bg-gray-50 min-h-screen",children:e.jsxs("div",{className:"mx-auto max-w-7xl px-4 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"-mb-px flex space-x-8 px-6",children:[e.jsxs(h,{href:route("production.orders.index"),className:`py-4 px-1 border-b-2 font-medium text-sm ${!i||i==="all"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Todos (",l.length,")"]}),e.jsxs(h,{href:route("production.orders.index",{status:"payment_approved"}),className:`py-4 px-1 border-b-2 font-medium text-sm ${i==="payment_approved"?"border-green-500 text-green-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Pronto p/ Produ√ß√£o (",g.payment_approved,")"]}),e.jsxs(h,{href:route("production.orders.index",{status:"in_production"}),className:`py-4 px-1 border-b-2 font-medium text-sm ${i==="in_production"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Em Produ√ß√£o (",g.in_production,")"]}),e.jsxs(h,{href:route("production.orders.index",{status:"ready_for_shipping"}),className:`py-4 px-1 border-b-2 font-medium text-sm ${i==="ready_for_shipping"?"border-teal-500 text-teal-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:["Prontos p/ Envio (",g.ready_for_shipping,")"]})]})})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:l.map(t=>e.jsx("div",{className:"bg-white rounded-lg shadow-md hover:shadow-lg transition-shadow cursor-pointer",onClick:()=>S(t),children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:t.client_name}),P(t.order_status)]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Kit:"})," ",t.child_name]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Bordado:"})," ",t.embroidery_color," ‚Ä¢ ",t.embroidery_position]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Vendedora:"})," ",t.user.name]}),t.production_started_at&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Iniciado:"})," ",c(t.production_started_at)]})]}),e.jsx("div",{className:"border-t pt-4 mb-4",children:(()=>{const a=C(t);return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total com Frete:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:d(a.totalAmount)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Valor Pago:"}),e.jsx("span",{className:`font-medium ${a.paidAmount>0?"text-green-600":"text-gray-500"}`,children:d(a.paidAmount)})]}),a.remainingAmount>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Restante:"}),e.jsx("span",{className:"font-medium text-orange-600",children:d(a.remainingAmount)})]}),t.payment_date&&e.jsxs("div",{className:"flex justify-between items-center text-xs",children:[e.jsx("span",{className:"text-gray-500",children:"Pago em:"}),e.jsx("span",{className:"text-gray-700",children:c(t.payment_date)})]})]})})()}),e.jsx("div",{className:"flex justify-center",children:k(t)})]})},t.id))}),l.length===0&&e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-12 text-center",children:[e.jsx("div",{className:"w-24 h-24 mx-auto mb-6 bg-gray-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-12 h-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19.428 15.428a2 2 0 00-1.022-.547l-2.387-.477a6 6 0 00-3.86.517l-.318.158a6 6 0 01-3.86.517L6.05 15.21a2 2 0 00-1.806.547M8 4h8l-1 1v5.172a2 2 0 00.586 1.414l5 5c1.26 1.26.367 3.414-1.415 3.414H4.828c-1.782 0-2.674-2.154-1.414-3.414l5-5A2 2 0 009 7.172V5L8 4z"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum pedido na produ√ß√£o"}),e.jsx("p",{className:"text-gray-500",children:"Todos os pedidos foram processados ou n√£o h√° pedidos pendentes."})]})]})}),y&&s&&f==="view"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-4xl max-h-[90vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Detalhes do Pedido - ",s.client_name]}),e.jsx("button",{onClick:()=>r(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-6",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Especifica√ß√µes do Produto"}),e.jsxs("div",{className:"space-y-3 bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Nome da Crian√ßa"}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:s.child_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Posi√ß√£o do Bordado"}),e.jsx("p",{className:"text-gray-900",children:s.embroidery_position})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Cor do Bordado"}),e.jsx("p",{className:"text-gray-900",children:s.embroidery_color})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Fonte"}),e.jsx("p",{className:"text-gray-900",children:s.embroidery_font})]})]}),e.jsx("h4",{className:"text-lg font-semibold mt-6 mb-4",children:"Informa√ß√µes do Cliente"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Cliente"}),e.jsx("p",{className:"text-gray-900",children:s.client_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Telefone"}),e.jsx("p",{className:"text-gray-900",children:s.client_phone||"N√£o informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Endere√ßo de Entrega"}),e.jsx("p",{className:"text-gray-900",children:s.delivery_address?e.jsxs(e.Fragment,{children:[s.delivery_address,", ",s.delivery_number,e.jsx("br",{}),s.delivery_complement&&`${s.delivery_complement}, `,s.delivery_neighborhood,e.jsx("br",{}),s.delivery_city,"/",s.delivery_state," - ",s.delivery_zipcode]}):"N√£o informado"})]})]}),e.jsx("h4",{className:"text-lg font-semibold mt-6 mb-4",children:"Informa√ß√µes Financeiras"}),e.jsx("div",{className:"space-y-3 bg-blue-50 p-4 rounded-lg",children:(()=>{const t=C(s);return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Total com Frete:"}),e.jsx("span",{className:"font-semibold text-gray-900",children:d(t.totalAmount)})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Valor Pago:"}),e.jsx("span",{className:`font-medium ${t.paidAmount>0?"text-green-700":"text-gray-500"}`,children:d(t.paidAmount)})]}),t.remainingAmount>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Valor Restante:"}),e.jsx("span",{className:"font-medium text-orange-700",children:d(t.remainingAmount)})]}),s.payment_date&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("label",{className:"text-sm font-medium text-gray-600",children:"Data do Pagamento:"}),e.jsx("span",{className:"text-gray-700",children:c(s.payment_date)})]}),t.isFullyPaid&&e.jsx("div",{className:"text-center",children:e.jsx("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-sm font-medium bg-green-100 text-green-800",children:"‚úÖ Pagamento Completo"})})]})})()})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Status da Produ√ß√£o"}),e.jsxs("div",{className:"space-y-4",children:[P(s.order_status),s.production_started_at&&e.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Produ√ß√£o Iniciada"}),e.jsx("p",{className:"text-blue-700",children:c(s.production_started_at)}),s.production_admin&&e.jsxs("p",{className:"text-sm text-blue-600",children:["Por: ",s.production_admin.name]})]}),s.photo_sent_at&&e.jsxs("div",{className:"bg-purple-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-purple-900",children:"Foto Enviada"}),e.jsx("p",{className:"text-purple-700",children:c(s.photo_sent_at)})]}),s.tracking_code&&e.jsxs("div",{className:"bg-green-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-green-900",children:"C√≥digo de Rastreio"}),e.jsx("p",{className:"font-mono text-green-700",children:s.tracking_code})]})]}),s.notes&&e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-600 mb-2",children:"Observa√ß√µes"}),e.jsx("p",{className:"text-gray-900 bg-gray-50 p-3 rounded-lg",children:s.notes})]})]})]})}),e.jsxs("div",{className:"flex justify-end gap-4 p-6 border-t bg-gray-50",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Fechar"}),k(s)]})]})}),y&&s&&f==="photo"&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("h2",{className:"text-xl font-bold text-gray-900",children:["Enviar Foto do Produto - ",s.child_name]}),e.jsx("button",{onClick:()=>r(!1),className:"p-2 hover:bg-gray-100 rounded-lg",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Foto do Produto Finalizado"}),e.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-lg hover:border-purple-400 transition-colors",children:e.jsx("div",{className:"space-y-1 text-center",children:N?e.jsxs("div",{children:[e.jsx("img",{src:N,alt:"Preview",className:"mx-auto h-48 w-auto rounded"}),e.jsx("p",{className:"text-sm text-gray-600 mt-2",children:(E=m.product_photo)==null?void 0:E.name})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),e.jsxs("div",{className:"flex text-sm text-gray-600",children:[e.jsxs("label",{htmlFor:"product_photo",className:"relative cursor-pointer rounded-md bg-white font-medium text-purple-600 hover:text-purple-500",children:[e.jsx("span",{children:"Selecionar foto"}),e.jsx("input",{id:"product_photo",type:"file",className:"sr-only",accept:"image/*",onChange:T,required:!0})]}),e.jsx("p",{className:"pl-1",children:"ou arraste aqui"})]}),e.jsx("p",{className:"text-xs text-gray-500",children:"PNG, JPG at√© 5MB"})]})})}),w.product_photo&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:w.product_photo})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observa√ß√µes (opcional)"}),e.jsx("textarea",{value:m.notes,onChange:t=>_("notes",t.target.value),rows:3,className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"Adicione observa√ß√µes sobre o produto..."})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 p-6 border-t bg-gray-50",children:[e.jsx("button",{onClick:()=>r(!1),className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:B,disabled:x||!m.product_photo,className:"px-6 py-2 bg-purple-500 text-white rounded-lg hover:bg-purple-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:x?"Enviando...":"Enviar para Aprova√ß√£o"})]})]})})]})]})}export{q as default};
