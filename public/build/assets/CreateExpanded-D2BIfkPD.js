import{x as oe,r as x,j as e,Q as le,a as k,V as h}from"./app-CtzdOJ_q.js";import{A as ie}from"./AuthenticatedLayout-D0mqaY0C.js";import{f as m,a as L,b as ne,p as de}from"./currency-nnCpYJTe.js";import"./transition-DPNstJ8m.js";function he(){var T;const{data:a,setData:i,post:M,processing:R,errors:c}=oe({client_name:"",client_email:"",client_phone:"",client_cpf:"",products:[],child_name:"",embroidery_position:"center",embroidery_color:"pink",embroidery_font:"cursive",total_amount:"",shipping_amount:"",payment_method:"pix",received_amount:"",payment_date:"",payment_receipt:null,delivery_address:"",delivery_number:"",delivery_complement:"",delivery_neighborhood:"",delivery_city:"",delivery_state:"",delivery_zipcode:"",notes:""}),[ce,me]=x.useState(!1),[D,V]=x.useState(null),[p,_]=x.useState({}),[f,O]=x.useState([]),[y,G]=x.useState([]),[j,I]=x.useState([]),[F,H]=x.useState([]),[$,W]=x.useState([]),[N,q]=x.useState(!0),[n,g]=x.useState({product_id:"",product_name:"",product_category:"",size:"P",quantity:1,unit_price:0,has_embroidery:!0,embroidery_text:"",embroidery_font:"",embroidery_color:"",embroidery_position:"",embroidery_design:""}),z={P:{name:"Pequeno (P)",basePrice:0},M:{name:"Médio (M)",basePrice:10},G:{name:"Grande (G)",basePrice:20},GG:{name:"Extra Grande (GG)",basePrice:30}};x.useEffect(()=>{(async()=>{try{q(!0);const[t,s,o,l,u]=await Promise.all([k.get("/api/embroidery/fonts"),k.get("/api/embroidery/colors"),k.get("/api/embroidery/positions"),k.get("/api/embroidery/designs"),k.get("/api/products")]);O(t.data),G(s.data),I(o.data),H(l.data),W(u.data),g(d=>({...d,embroidery_font:t.data.length>0?t.data[0].id:"",embroidery_color:s.data.length>0?s.data[0].id:"",embroidery_position:o.data.length>0?o.data[0].id:"",embroidery_design:l.data.length>0?l.data[0].id:""})),q(!1)}catch(t){console.error("Error fetching options:",t),h.error("Erro ao carregar opções"),q(!1)}})()},[]);const K=()=>{var A;if(!n.product_id)return{unitTotal:0,totalPrice:0,breakdown:{}};const r=parseFloat(n.unit_price||0),t=parseFloat(((A=z[n.size])==null?void 0:A.basePrice)||0),s=parseInt(n.quantity||1);let o=0;const l=f.find(P=>P.id==n.embroidery_font),u=y.find(P=>P.id==n.embroidery_color),d=j.find(P=>P.id==n.embroidery_position),v=parseFloat((l==null?void 0:l.additional_cost)||0),w=parseFloat((u==null?void 0:u.additional_cost)||0),E=parseFloat((d==null?void 0:d.additional_cost)||0);o=v+w+E;const C=r+t+o,b=C*s;return{unitTotal:C,totalPrice:b,breakdown:{basePrice:r,sizePrice:t,embroideryCost:{total:o,font:v,color:w,position:E},quantity:s}}},Q=r=>{const t=$.find(s=>s.id==r);t&&g(s=>({...s,product_id:r,product_name:t.name,product_category:t.product_category?t.product_category.name:"N/A",unit_price:parseFloat(t.price||0),embroidery_text:a.child_name||""}))},U=()=>{var C;if(!n.product_id){h.error("Por favor, selecione um produto");return}if(!n.embroidery_design){h.error("Por favor, selecione um design para bordado");return}if(!a.child_name||!a.child_name.trim()){h.error("Por favor, digite o nome da criança primeiro");return}const r=parseFloat(n.unit_price||0),t=parseFloat(((C=z[n.size])==null?void 0:C.basePrice)||0),s=parseInt(n.quantity||1);let o=0;const l=f.find(b=>b.id==n.embroidery_font),u=y.find(b=>b.id==n.embroidery_color),d=j.find(b=>b.id==n.embroidery_position);l&&(o+=parseFloat(l.additional_cost||0)),u&&(o+=parseFloat(u.additional_cost||0)),d&&(o+=parseFloat(d.additional_cost||0));const v=r+t+o,w=v*s;console.log("🧮 Calculation Debug:",{basePrice:r,sizePrice:t,embroideryCost:o,quantity:s,unitTotal:v,productTotal:w,fontCost:(l==null?void 0:l.additional_cost)||0,colorCost:(u==null?void 0:u.additional_cost)||0,positionCost:(d==null?void 0:d.additional_cost)||0});const E={...n,id:Date.now(),unit_price:r,size_price:t,embroidery_cost:o,quantity:s,unit_total:v,total_price:w};i("products",[...a.products,E]),g({product_id:"",product_name:"",product_category:"",size:"P",quantity:1,unit_price:0,has_embroidery:!0,embroidery_text:a.child_name||"",embroidery_font:f.length>0?f[0].id:"",embroidery_color:y.length>0?y[0].id:"",embroidery_position:j.length>0?j[0].id:"",embroidery_design:F.length>0?F[0].id:""}),h.success("Produto adicionado ao carrinho!")},J=r=>{const t=a.products.filter((s,o)=>o!==r);i("products",t),h.success("Produto removido do carrinho!")};x.useEffect(()=>{(()=>{const t=a.products.reduce((l,u)=>l+parseFloat(u.total_price||0),0),s=parseFloat(a.shipping_amount||0),o=t+s;i("total_amount",o.toFixed(2)),console.log("💰 Total Calculation:",{productsCount:a.products.length,productsTotal:t,shippingAmount:s,totalAmount:o,products:a.products.map(l=>({name:l.product_name,total:l.total_price,qty:l.quantity}))})})()},[a.products,a.shipping_amount]);const X=r=>{const t=r.target.files[0];if(t){i("payment_receipt",t);const s=new FileReader;s.onloadend=()=>{V(s.result)},s.readAsDataURL(t)}},B=ne,S=de,Y=()=>{const r=[];if(!a.products||a.products.length===0?r.push({field:"products",message:"🛍️ Por favor, adicione pelo menos um produto ao carrinho",section:"Produtos"}):a.products.forEach((o,l)=>{o.embroidery_design||r.push({field:`products[${l}].embroidery_design`,message:`🎨 Produto "${o.product_name}" precisa de um design para bordado`,section:"Produtos"})}),(!a.client_name||!a.client_name.trim())&&r.push({field:"client_name",message:"👤 Nome da cliente é obrigatório",section:"Dados da Cliente"}),!a.client_email||!a.client_email.trim()?r.push({field:"client_email",message:"📧 E-mail da cliente é obrigatório",section:"Dados da Cliente"}):/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a.client_email)||r.push({field:"client_email",message:"📧 Por favor, insira um e-mail válido (ex: cliente@email.com)",section:"Dados da Cliente"}),!a.client_phone||!a.client_phone.trim())r.push({field:"client_phone",message:"📱 Telefone da cliente é obrigatório",section:"Dados da Cliente"});else{const o=/^\d{10,11}$/,l=a.client_phone.replace(/\D/g,"");o.test(l)||r.push({field:"client_phone",message:"📱 Telefone deve ter 10 ou 11 dígitos (ex: (11) 98765-4321)",section:"Dados da Cliente"})}if(a.client_cpf&&a.client_cpf.trim()){const o=/^\d{11}$/,l=a.client_cpf.replace(/\D/g,"");o.test(l)||r.push({field:"client_cpf",message:"🆔 CPF deve ter 11 dígitos (ex: 123.456.789-00)",section:"Dados da Cliente"})}(!a.child_name||!a.child_name.trim())&&r.push({field:"child_name",message:"👶 Nome da criança é obrigatório para personalização",section:"Dados da Criança"}),(!a.shipping_amount||parseFloat(a.shipping_amount)<0)&&r.push({field:"shipping_amount",message:"🚚 Valor do frete é obrigatório e deve ser maior ou igual a zero",section:"Pagamento"}),(!a.received_amount||parseFloat(a.received_amount)<=0)&&r.push({field:"received_amount",message:"💰 Valor recebido é obrigatório e deve ser maior que zero",section:"Pagamento"}),a.payment_date||r.push({field:"payment_date",message:"📅 Data do pagamento é obrigatória",section:"Pagamento"}),a.payment_method||r.push({field:"payment_method",message:"💳 Forma de pagamento deve ser selecionada",section:"Pagamento"});const t=parseFloat(a.total_amount||0),s=parseFloat(a.received_amount||0);if(s>t&&t>0&&r.push({field:"received_amount",message:`💰 Valor recebido (${m(s)}) não pode ser maior que o total (${m(t)})`,section:"Pagamento"}),r.length>0){const o={};return r.forEach(l=>{o[l.field]=l.message}),_(o),h.error(r[0].message),console.log("❌ Validation Errors:",r),r.length>1&&setTimeout(()=>{h.error(`⚠️ Total de ${r.length} erros encontrados. Verifique todos os campos destacados.`)},1e3),setTimeout(()=>{const l=document.querySelector(`[name="${r[0].field}"], #${r[0].field}`);l&&(l.scrollIntoView({behavior:"smooth",block:"center"}),l.focus())},500),!1}return _({}),console.log("✅ Form validation passed"),!0},Z=r=>{r.preventDefault(),Y()&&M(route("sales.store"),{onSuccess:()=>{h.success("Venda registrada com sucesso! Cliente receberá o link personalizado. 🎉")},onError:t=>{Object.keys(t).forEach(s=>{h.error(t[s])})}})},ee=r=>{const t=r.replace(/\D/g,""),s=t.match(/^(\d{2})(\d{5})(\d{4})$/);if(s)return`(${s[1]}) ${s[2]}-${s[3]}`;const o=t.match(/^(\d{2})(\d{4})(\d{4})$/);return o?`(${o[1]}) ${o[2]}-${o[3]}`:r},re=r=>{const s=r.replace(/\D/g,"").match(/^(\d{3})(\d{3})(\d{3})(\d{2})$/);return s?`${s[1]}.${s[2]}.${s[3]}-${s[4]}`:r},te=r=>{const s=r.replace(/\D/g,"").match(/^(\d{5})(\d{3})$/);return s?`${s[1]}-${s[2]}`:r},ae={pix:"PIX",boleto:"Boleto",cartao:"Cartão",dinheiro:"Dinheiro"},se=["AC","AL","AP","AM","BA","CE","DF","ES","GO","MA","MT","MS","MG","PA","PB","PR","PE","PI","RJ","RN","RS","RO","RR","SC","SP","SE","TO"];return e.jsxs(e.Fragment,{children:[e.jsx(le,{title:"Registrar Venda Completa"}),e.jsx(ie,{header:e.jsxs("div",{className:"bg-gradient-to-r from-purple-600 to-pink-600 text-white p-6 rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-2xl font-bold",children:"✨ Novo Pedido BBKits"}),e.jsx("p",{className:"text-purple-100 mt-1",children:"Preencha todos os dados do pedido para gerar o link personalizado da cliente"})]}),children:e.jsx("div",{className:"py-12 bg-gray-50 min-h-screen",children:e.jsx("div",{className:"mx-auto max-w-5xl px-4 sm:px-6 lg:px-8",children:e.jsxs("form",{onSubmit:Z,className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-purple-100 text-purple-600 rounded-lg flex items-center justify-center",children:"👤"}),"Dados da Cliente"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo *"}),e.jsx("input",{type:"text",name:"client_name",value:a.client_name,onChange:r=>{i("client_name",r.target.value),p.client_name&&_(t=>({...t,client_name:void 0}))},className:`w-full rounded-lg focus:ring-purple-500 ${p.client_name?"border-red-500 focus:border-red-500 bg-red-50":"border-gray-300 focus:border-purple-500"}`,placeholder:"Maria Silva",required:!0}),(c.client_name||p.client_name)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.client_name||c.client_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"E-mail *"}),e.jsx("input",{type:"email",name:"client_email",value:a.client_email,onChange:r=>{i("client_email",r.target.value),p.client_email&&_(t=>({...t,client_email:void 0}))},className:`w-full rounded-lg focus:ring-purple-500 ${p.client_email?"border-red-500 focus:border-red-500 bg-red-50":"border-gray-300 focus:border-purple-500"}`,placeholder:"maria@email.com",required:!0}),(c.client_email||p.client_email)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.client_email||c.client_email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone *"}),e.jsx("input",{type:"tel",value:a.client_phone,onChange:r=>i("client_phone",ee(r.target.value)),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"(11) 98765-4321",required:!0}),c.client_phone&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.client_phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CPF"}),e.jsx("input",{type:"text",value:a.client_cpf,onChange:r=>i("client_cpf",re(r.target.value)),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"123.456.789-00"}),c.client_cpf&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.client_cpf})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center",children:"🛍️"}),"Seleção de Produto"]}),N?e.jsxs("div",{className:"flex justify-center items-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Carregando produtos..."})]}):$.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx("svg",{className:"w-8 h-8 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M20 13V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7m16 0v5a2 2 0 01-2 2H6a2 2 0 01-2-2v-5m16 0h-2M4 13h2m13-8V6a2 2 0 00-2-2H6a2 2 0 00-2 2v7h16"})})}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum produto encontrado"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Não há produtos disponíveis no momento. Entre em contato com o administrador para adicionar produtos ao catálogo."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(r=>{var t;return e.jsxs("div",{onClick:()=>Q(r.id),className:`
                                                    relative cursor-pointer rounded-lg border-2 p-4 transition-all duration-200 hover:shadow-lg
                                                    ${n.product_id==r.id?"border-purple-500 bg-purple-50 shadow-md":"border-gray-200 hover:border-purple-300"}
                                                `,children:[n.product_id==r.id&&e.jsx("div",{className:"absolute top-2 right-2 w-6 h-6 bg-purple-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-4 h-4 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("div",{className:"aspect-w-3 aspect-h-2 mb-4",children:e.jsx("img",{src:r.image_url&&r.image_url.trim()!==""?r.image_url:"https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=300&h=200&fit=crop",alt:r.name,className:"w-full h-32 object-cover rounded-md transition-opacity duration-200",onError:s=>{s.target.src!=="https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=300&h=200&fit=crop"&&(s.target.src="https://images.unsplash.com/photo-1553062407-98eeb64c6a62?w=300&h=200&fit=crop")}})}),e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:r.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-3 line-clamp-2",children:r.description}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-purple-600",children:m(r.price)}),e.jsxs("span",{className:"text-sm text-gray-500",children:["Est: ",r.stock_quantity]})]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"text-xs text-gray-500",children:"Tamanhos:"}),(t=r.available_sizes)==null?void 0:t.map(s=>e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-xs rounded",children:s},s))]}),r.allows_embroidery&&e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded",children:"✨ Aceita bordado"})})]})]},r.id)})}),n.product_id&&e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-blue-800 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 100 4m0-4v2m0-6V4"})}),"Personalizar Produto: ",n.product_name]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tamanho"}),e.jsx("select",{value:n.size,onChange:r=>g(t=>({...t,size:r.target.value})),className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500",children:Object.entries(z).map(([r,t])=>e.jsxs("option",{value:r,children:[t.name," ",t.basePrice>0&&`(+R$ ${t.basePrice})`]},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Quantidade"}),e.jsx("input",{type:"number",min:"1",value:n.quantity,onChange:r=>g(t=>({...t,quantity:parseInt(r.target.value)||1})),className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"🎨 Design do Bordado"}),e.jsxs("select",{value:n.embroidery_design,onChange:r=>g(t=>({...t,embroidery_design:r.target.value})),className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500 mb-4",disabled:N,children:[e.jsx("option",{value:"",children:"Selecione um design"}),F.map(r=>e.jsxs("option",{value:r.id,children:[r.name," - ",r.description]},r.id))]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"text-blue-600",children:"📝"}),e.jsx("span",{className:"text-blue-700 font-medium",children:"Nome para bordado:"}),e.jsx("span",{className:"text-blue-900 font-semibold",children:a.child_name||"Digite o nome da criança abaixo"})]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"O nome será automaticamente usado para todos os bordados"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fonte"}),e.jsx("select",{value:n.embroidery_font,onChange:r=>g(t=>({...t,embroidery_font:r.target.value})),className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:N,children:f.map(r=>e.jsxs("option",{value:r.id,children:[r.display_name||r.name,r.additional_cost>0&&` (+R$ ${r.additional_cost})`]},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cor"}),e.jsx("select",{value:n.embroidery_color,onChange:r=>g(t=>({...t,embroidery_color:r.target.value})),className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:N,children:y.map(r=>e.jsxs("option",{value:r.id,children:[r.name,r.additional_cost>0&&` (+R$ ${r.additional_cost})`]},r.id))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posição"}),e.jsx("select",{value:n.embroidery_position,onChange:r=>g(t=>({...t,embroidery_position:r.target.value})),className:"w-full rounded-md border-gray-300 focus:border-blue-500 focus:ring-blue-500",disabled:N,children:j.map(r=>e.jsxs("option",{value:r.id,children:[r.display_name||r.name,r.additional_cost>0&&` (+R$ ${r.additional_cost})`]},r.id))})]})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"text-sm text-gray-600",children:(()=>{var s;const r=K(),{breakdown:t}=r;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{children:["Base: ",e.jsx("span",{className:"font-medium",children:m(t.basePrice||0)}),t.sizePrice>0&&e.jsxs("span",{children:[" + Tamanho: ",e.jsx("span",{className:"font-medium",children:m(t.sizePrice)})]}),((s=t.embroideryCost)==null?void 0:s.total)>0&&e.jsxs("span",{children:[" + Bordado: ",e.jsx("span",{className:"font-medium",children:m(t.embroideryCost.total)})]})]}),e.jsxs("div",{className:"font-semibold text-purple-600",children:["Unitário: ",m(r.unitTotal)," × ",t.quantity," = ",e.jsx("span",{className:"text-lg",children:m(r.totalPrice)})]})]})})()}),e.jsxs("button",{type:"button",onClick:U,disabled:!n.product_id||!n.embroidery_design||!((T=a.child_name)!=null&&T.trim()),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Adicionar ao Carrinho"]})]})]}),a.products&&a.products.length>0&&e.jsxs("div",{className:"mt-6 p-4 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("h4",{className:"font-medium text-green-800 mb-4 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.1 5M6 18a2 2 0 100 4 2 2 0 000-4zm10 0a2 2 0 100 4 2 2 0 000-4z"})}),"Carrinho (",a.products.length," ",a.products.length===1?"item":"itens",")"]}),e.jsx("div",{className:"space-y-3",children:a.products.map((r,t)=>{var s,o,l,u;return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:r.product_name}),e.jsxs("div",{className:"text-sm text-gray-600",children:[r.embroidery_text," • Tamanho: ",r.size," • Qtd: ",r.quantity]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[((s=F.find(d=>d.id==r.embroidery_design))==null?void 0:s.name)||"Sem design"," •",((o=f.find(d=>d.id==r.embroidery_font))==null?void 0:o.display_name)||"Fonte"," •",((l=y.find(d=>d.id==r.embroidery_color))==null?void 0:l.name)||"Cor"," •",((u=j.find(d=>d.id==r.embroidery_position))==null?void 0:u.display_name)||"Posição"]})]}),e.jsxs("div",{className:"text-right mr-4",children:[e.jsx("div",{className:"font-bold text-green-600",children:m(r.total_price||0)}),e.jsxs("div",{className:"text-xs text-gray-500",children:[m(r.unit_total||parseFloat(r.unit_price||0)+parseFloat(r.size_price||0)+parseFloat(r.embroidery_cost||0))," × ",r.quantity]}),e.jsxs("div",{className:"text-xs text-gray-400",children:["Base: ",m(r.unit_price||0),r.size_price>0&&` +${m(r.size_price)}`,r.embroidery_cost>0&&` +${m(r.embroidery_cost)}`]})]}),e.jsx("button",{type:"button",onClick:()=>J(t),className:"text-red-600 hover:text-red-800 p-1",title:"Remover item",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]},r.id||t)})}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-green-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"font-medium text-green-800",children:"Total dos Produtos:"}),e.jsx("span",{className:"font-bold text-green-600 text-lg",children:m(a.products.reduce((r,t)=>r+parseFloat(t.total_price||0),0))})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:[a.products.length," ",a.products.length===1?"produto":"produtos"," • Unidades: ",a.products.reduce((r,t)=>r+parseInt(t.quantity||0),0)]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-green-100 text-green-600 rounded-lg flex items-center justify-center",children:"💰"}),"Informações de Pagamento"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total dos Produtos"}),e.jsx("div",{className:"w-full rounded-lg border-gray-300 bg-gray-50 px-3 py-2 text-gray-700 font-semibold",children:m(a.products.reduce((r,t)=>r+parseFloat(t.total_price||0),0))}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[a.products.length," ",a.products.length===1?"produto":"produtos"," no carrinho"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Total Geral (Produtos + Frete)"}),e.jsx("div",{className:"w-full rounded-lg border-gray-300 bg-green-50 px-3 py-2 text-green-700 font-bold text-lg",children:m(a.products.reduce((r,t)=>r+parseFloat(t.total_price||0),0)+parseFloat(a.shipping_amount||0))}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Este é o valor total que a cliente pagará"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor do Frete *"}),e.jsx("input",{type:"text",value:a.shipping_amount?L(a.shipping_amount):"",onChange:r=>{const t=B(r.target.value),s=S(t);i("shipping_amount",s)},className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"25,00",required:!0}),c.shipping_amount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.shipping_amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Forma de Pagamento *"}),e.jsx("select",{value:a.payment_method,onChange:r=>i("payment_method",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",required:!0,children:Object.entries(ae).map(([r,t])=>e.jsx("option",{value:r,children:t},r))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Recebido *"}),e.jsx("input",{type:"text",value:a.received_amount?L(a.received_amount):"",onChange:r=>{const t=B(r.target.value),s=S(t);i("received_amount",s)},className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"150,00",required:!0}),c.received_amount&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.received_amount}),a.received_amount&&a.total_amount&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:parseFloat(a.received_amount)<parseFloat(a.total_amount)?e.jsxs("span",{className:"text-orange-600",children:["⚠️ Pagamento parcial - Restante: ",m(parseFloat(a.total_amount)-parseFloat(a.received_amount))]}):e.jsx("span",{className:"text-green-600",children:"✅ Pagamento completo"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Data do Pagamento *"}),e.jsx("input",{type:"date",value:a.payment_date,onChange:r=>i("payment_date",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",required:!0}),c.payment_date&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.payment_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Comprovante de Pagamento"}),e.jsx("input",{type:"file",onChange:X,accept:"image/*,.pdf",className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500"}),c.payment_receipt&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.payment_receipt}),D&&e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Pré-visualização:"}),e.jsx("img",{src:D,alt:"Comprovante de pagamento",className:"max-w-xs max-h-32 object-contain rounded-lg border"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-pink-100 text-pink-600 rounded-lg flex items-center justify-center",children:"👶"}),"Dados da Criança"]}),e.jsx("div",{className:"max-w-md",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Criança *"}),e.jsx("input",{type:"text",name:"child_name",value:a.child_name,onChange:r=>{const t=r.target.value;i("child_name",t),n.product_id&&g(s=>({...s,embroidery_text:t})),a.products.length>0&&i("products",a.products.map(s=>({...s,embroidery_text:t}))),p.child_name&&_(s=>({...s,child_name:void 0}))},className:`w-full rounded-lg focus:ring-purple-500 ${p.child_name?"border-red-500 focus:border-red-500 bg-red-50":"border-gray-300 focus:border-purple-500"}`,placeholder:"Helena",required:!0}),(c.child_name||p.child_name)&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:p.child_name||c.child_name}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Este nome será usado como sugestão para bordados"})]})})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-blue-100 text-blue-600 rounded-lg flex items-center justify-center",children:"📦"}),"Endereço de Entrega",e.jsx("span",{className:"text-sm font-normal text-gray-500",children:"(Opcional - Cliente pode preencher depois)"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Endereço"}),e.jsx("input",{type:"text",value:a.delivery_address,onChange:r=>i("delivery_address",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"Rua das Flores"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número"}),e.jsx("input",{type:"text",value:a.delivery_number,onChange:r=>i("delivery_number",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"123"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Complemento"}),e.jsx("input",{type:"text",value:a.delivery_complement,onChange:r=>i("delivery_complement",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"Apto 12B"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bairro"}),e.jsx("input",{type:"text",value:a.delivery_neighborhood,onChange:r=>i("delivery_neighborhood",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"Jardim Primavera"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade"}),e.jsx("input",{type:"text",value:a.delivery_city,onChange:r=>i("delivery_city",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"São Paulo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),e.jsxs("select",{value:a.delivery_state,onChange:r=>i("delivery_state",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",children:[e.jsx("option",{value:"",children:"Selecione..."}),se.map(r=>e.jsx("option",{value:r,children:r},r))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP"}),e.jsx("input",{type:"text",value:a.delivery_zipcode,onChange:r=>i("delivery_zipcode",te(r.target.value)),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"01234-567"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-6 flex items-center gap-2",children:[e.jsx("span",{className:"w-8 h-8 bg-orange-100 text-orange-600 rounded-lg flex items-center justify-center",children:"🎨"}),"Especificações do Kit (Preenchimento Manual)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mesa livre (detalhes no bolso frontal) *"}),e.jsx("textarea",{value:a.mesa_livre_details||"",onChange:r=>i("mesa_livre_details",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",rows:3,placeholder:"Ex: Bolso frontal com detalhes específicos...",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chaveiros *"}),e.jsx("input",{type:"text",value:a.chaveiros||"",onChange:r=>i("chaveiros",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: 2x chaveiros personalizados",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cor principal do kit *"}),e.jsx("input",{type:"text",value:a.kit_main_color||"",onChange:r=>i("kit_main_color",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: Azul marinho",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alças *"}),e.jsx("input",{type:"text",value:a.alcas||"",onChange:r=>i("alcas",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: Pretas, material resistente",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Faixa *"}),e.jsx("input",{type:"text",value:a.faixa||"",onChange:r=>i("faixa",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: Rosa com detalhes dourados",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Friso (contorno da bolsa) *"}),e.jsx("input",{type:"text",value:a.friso||"",onChange:r=>i("friso",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: Contorno branco",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Viés (contorno dos bolsos laterais) *"}),e.jsx("input",{type:"text",value:a.vies||"",onChange:r=>i("vies",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: Azul claro nos bolsos laterais",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Zíper *"}),e.jsx("input",{type:"text",value:a.ziper||"",onChange:r=>i("ziper",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",placeholder:"Ex: Dourado YKK",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Previsão de confecção *"}),e.jsx("input",{type:"date",value:a.production_estimate||"",onChange:r=>i("production_estimate",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Previsão de entrega *"}),e.jsx("input",{type:"date",value:a.delivery_estimate||"",onChange:r=>i("delivery_estimate",r.target.value),className:"w-full rounded-lg border-gray-300 focus:border-orange-500 focus:ring-orange-500",required:!0})]})]}),e.jsx("div",{className:"mt-6 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-orange-500 text-lg",children:"ℹ️"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-orange-800 font-medium",children:"Controle de Inventário - Etapa 3"}),e.jsx("p",{className:"text-orange-700 text-sm",children:"Estas especificações são essenciais para o controle de inventário e planejamento da produção. Todos os campos são obrigatórios para garantir informações completas ao cliente."})]})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 justify-end",children:[e.jsx("a",{href:route("sales.index"),className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors text-center",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:R,className:"px-6 py-3 bg-gradient-to-r from-purple-600 to-pink-600 text-white rounded-lg hover:from-purple-700 hover:to-pink-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:R?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Registrar Pedido"]})})]})]})})})})]})}export{he as default};
