import{r as i,j as e,Q as N}from"./app-S6oqnh5N.js";import{A as y}from"./AuthenticatedLayout-XG8Hx4Hk.js";import"./transition-DCXB1xLo.js";function I({stats:n}){const[t,x]=i.useState(null),[h,d]=i.useState(null),[r,u]=i.useState(null),[p,g]=i.useState(!1),o=i.useRef(null),[a,c]=i.useState({category_id:"",supplier_id:"",active_only:!1}),j=s=>{const l=s.target.files[0];x(l),u(null)},f=async()=>{if(!t){alert("Por favor, selecione um arquivo CSV");return}g(!0),d("Enviando arquivo...");const s=new FormData;s.append("file",t);try{const m=await(await fetch(route("admin.materials.import"),{method:"POST",body:s,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content")}})).json();m.success?(u(m.results),d("Importação concluída!"),x(null),o.current&&(o.current.value="")):d("Erro na importação: "+m.message)}catch(l){d("Erro na importação: "+l.message)}finally{g(!1)}},v=()=>{const s=new URLSearchParams(a);window.location.href=route("admin.materials.export")+"?"+s.toString()},b=()=>{window.location.href=route("admin.materials.export-template")};return e.jsxs(y,{header:e.jsx("div",{className:"flex justify-between items-center",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Importar/Exportar Materiais"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Gerencie materiais em massa através de arquivos CSV"})]})}),children:[e.jsx(N,{title:"Importar/Exportar Materiais"}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border border-blue-200",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-blue-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"📦"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Total de Materiais"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.total_materials})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border border-purple-200",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-purple-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"📁"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Categorias"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.total_categories})]})})]})})}),e.jsx("div",{className:"bg-white overflow-hidden shadow rounded-lg border border-green-200",children:e.jsx("div",{className:"p-5",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"w-8 h-8 bg-green-600 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-medium",children:"🏢"})})}),e.jsx("div",{className:"ml-5 w-0 flex-1",children:e.jsxs("dl",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500 truncate",children:"Fornecedores"}),e.jsx("dd",{className:"text-lg font-medium text-gray-900",children:n.total_suppliers})]})})]})})})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"📤 Exportar Materiais"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Categoria"}),e.jsx("select",{value:a.category_id,onChange:s=>c({...a,category_id:s.target.value}),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",children:e.jsx("option",{value:"",children:"Todas as categorias"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fornecedor"}),e.jsx("select",{value:a.supplier_id,onChange:s=>c({...a,supplier_id:s.target.value}),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",children:e.jsx("option",{value:"",children:"Todos os fornecedores"})})]}),e.jsxs("div",{className:"flex items-center pt-6",children:[e.jsx("input",{type:"checkbox",id:"active-only",checked:a.active_only,onChange:s=>c({...a,active_only:s.target.checked}),className:"h-4 w-4 text-purple-600 focus:ring-purple-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"active-only",className:"ml-2 block text-sm text-gray-900",children:"Apenas materiais ativos"})]})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsx("button",{onClick:v,className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"Exportar CSV"}),e.jsx("button",{onClick:b,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"Baixar Template"})]})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"📥 Importar Materiais"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Arquivo CSV"}),e.jsx("input",{ref:o,type:"file",accept:".csv,.txt",onChange:j,className:"block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-purple-50 file:text-purple-700 hover:file:bg-purple-100"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Máximo 10MB. Use o template para garantir o formato correto."})]}),t&&e.jsx("div",{className:"mb-4 p-4 bg-blue-50 rounded-lg",children:e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"text-blue-600 text-sm font-medium",children:["📄 ",t.name," (",(t.size/1024).toFixed(1)," KB)"]})})}),h&&e.jsx("div",{className:"mb-4 p-4 bg-yellow-50 rounded-lg",children:e.jsx("div",{className:"text-yellow-800",children:h})}),r&&e.jsxs("div",{className:"mb-4 p-4 bg-green-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-green-800 mb-2",children:"Resultados da Importação"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Total:"})," ",r.total_rows]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Processados:"})," ",r.processed]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-green-600",children:"Criados:"})," ",r.created]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-blue-600",children:"Atualizados:"})," ",r.updated]})]}),r.errors.length>0&&e.jsxs("div",{className:"mt-4",children:[e.jsxs("h5",{className:"font-medium text-red-800 mb-2",children:["Erros (",r.errors.length,"):"]}),e.jsxs("ul",{className:"text-sm text-red-700 space-y-1",children:[r.errors.slice(0,10).map((s,l)=>e.jsxs("li",{children:["• ",s]},l)),r.errors.length>10&&e.jsxs("li",{children:["... e mais ",r.errors.length-10," erros"]})]})]})]}),e.jsx("button",{onClick:f,disabled:!t||p,className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:p?"Importando...":"Importar Arquivo"})]})]}),e.jsxs("div",{className:"bg-white shadow rounded-lg",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"📋 Instruções"})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"prose text-sm text-gray-600",children:[e.jsx("h4",{className:"text-gray-900 font-medium mb-2",children:"Formato do arquivo CSV:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 mb-4",children:[e.jsx("li",{children:"Use o template fornecido para garantir o formato correto"}),e.jsx("li",{children:"Campos obrigatórios: reference, name, unit"}),e.jsx("li",{children:"Use category_code para associar a uma categoria existente"}),e.jsx("li",{children:"Use supplier_name para associar a um fornecedor existente"}),e.jsx("li",{children:"Materiais existentes serão atualizados baseado na referência"})]}),e.jsx("h4",{className:"text-gray-900 font-medium mb-2",children:"Unidades válidas:"}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("strong",{children:"Peso:"})," g, kg, t"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Volume:"})," ml, l, m³"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Comprimento:"})," mm, cm, m, km"]}),e.jsxs("div",{children:[e.jsx("strong",{children:"Contagem:"})," un, pç, par, dz, cx"]})]})]})})]})]})})]})}export{I as default};
