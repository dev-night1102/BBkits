import{x as b,r as v,j as e,Q as f,t as y,V as x}from"./app-BInj9Udq.js";import{A as N}from"./AuthenticatedLayout-BvFke1Se.js";import"./transition-nK4ZK89a.js";function w({materials:d,selectedMaterial:i}){const{data:s,setData:n,post:p,processing:c,errors:t}=b({material_id:(i==null?void 0:i.id)||"",quantity:"",type:"adjustment",reference:"",notes:"",unit_cost:""}),[a,h]=v.useState(i),g=r=>{const o=d.find(l=>l.id==r);h(o),n("material_id",r)},j=r=>{r.preventDefault(),p(route("admin.inventory.store"),{onSuccess:()=>{x.success("Transação criada com sucesso!")},onError:o=>{Object.keys(o).forEach(l=>{x.error(o[l])})}})},u=()=>{if(!s.type||!a)return"";switch(s.type){case"purchase":return"Informe a quantidade adquirida (valor positivo)";case"consumption":return`Informe a quantidade consumida (máximo: ${a.current_stock} ${a.unit})`;case"adjustment":return"Informe o ajuste: positivo para adicionar, negativo para remover";case"return":return"Informe a quantidade devolvida (valor positivo)";default:return""}},m=(r,o)=>Number(r).toLocaleString("pt-BR",{minimumFractionDigits:3})+" "+o;return e.jsxs(N,{header:e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nova Transação de Estoque"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Registre movimentações de estoque com histórico completo"})]}),children:[e.jsx(f,{title:"Nova Transação de Estoque"}),e.jsx("div",{className:"py-12",children:e.jsx("div",{className:"max-w-3xl mx-auto sm:px-6 lg:px-8",children:e.jsx("div",{className:"bg-white shadow rounded-lg",children:e.jsxs("form",{onSubmit:j,className:"space-y-6 p-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Material *"}),e.jsxs("select",{value:s.material_id,onChange:r=>g(r.target.value),className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${t.material_id?"border-red-500":""}`,required:!0,children:[e.jsx("option",{value:"",children:"Selecione um material"}),d.map(r=>e.jsxs("option",{value:r.id,children:[r.reference," - ",r.name," (Estoque: ",m(r.current_stock,r.unit),")"]},r.id))]}),t.material_id&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.material_id})]}),a&&e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-2",children:"Estoque Atual"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Material:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Estoque:"}),e.jsx("span",{className:"ml-2 font-medium",children:m(a.current_stock,a.unit)})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Unidade:"}),e.jsx("span",{className:"ml-2 font-medium",children:a.unit})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Transação *"}),e.jsxs("select",{value:s.type,onChange:r=>n("type",r.target.value),className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${t.type?"border-red-500":""}`,required:!0,children:[e.jsx("option",{value:"purchase",children:"Compra"}),e.jsx("option",{value:"consumption",children:"Consumo"}),e.jsx("option",{value:"adjustment",children:"Ajuste Manual"}),e.jsx("option",{value:"return",children:"Devolução"})]}),t.type&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.type})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantidade *"}),e.jsx("input",{type:"number",step:"0.001",value:s.quantity,onChange:r=>n("quantity",r.target.value),className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${t.quantity?"border-red-500":""}`,placeholder:"0.000",required:!0}),u()&&e.jsx("p",{className:"mt-1 text-xs text-gray-600",children:u()}),t.quantity&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.quantity})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referência"}),e.jsx("input",{type:"text",value:s.reference,onChange:r=>n("reference",r.target.value),className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${t.reference?"border-red-500":""}`,placeholder:"Ex: NF 12345, Pedido #567, Ajuste Inventário"}),t.reference&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.reference})]}),s.type==="purchase"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custo Unitário (R$)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:s.unit_cost,onChange:r=>n("unit_cost",r.target.value),className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${t.unit_cost?"border-red-500":""}`,placeholder:"0.00"}),t.unit_cost&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.unit_cost})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:s.notes,onChange:r=>n("notes",r.target.value),rows:3,className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${t.notes?"border-red-500":""}`,placeholder:"Detalhes adicionais sobre a transação..."}),t.notes&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:t.notes})]}),e.jsxs("div",{className:"flex justify-end space-x-4 pt-6 border-t",children:[e.jsx(y,{href:route("admin.inventory.index"),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:c,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:c?"Salvando...":"Criar Transação"})]})]})})})})]})}export{w as default};
