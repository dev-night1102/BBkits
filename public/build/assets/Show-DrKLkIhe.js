import{J as k,r as S,x as q,j as e,Q as E,t as a,V as g}from"./app-CcCqpfhZ.js";import{A as C}from"./AuthenticatedLayout-DjtgMhk1.js";import"./transition-xVG7TShl.js";function M({material:s,transactions:i}){const{auth:h}=k().props,m=h.user,[x,n]=S.useState(!1),{data:d,setData:l,post:y,processing:o,errors:c,reset:j}=q({quantity:"",type:"adjustment",reference:"",notes:"",unit_cost:""}),N=t=>{t.preventDefault(),y(route("admin.materials.adjust-stock",s.id),{onSuccess:()=>{g.success("Estoque ajustado com sucesso!"),j(),n(!1)},onError:r=>{Object.keys(r).forEach(_=>{g.error(r[_])})}})},f=()=>["admin","manager","production_admin"].includes(m.role),b=()=>["admin","manager","production_admin"].includes(m.role),v=()=>["admin","manager","production_admin"].includes(m.role),w=t=>"R$ "+Number(t).toLocaleString("pt-BR",{minimumFractionDigits:2}),p=(t,r)=>Number(t).toLocaleString("pt-BR",{minimumFractionDigits:3})+" "+r,u=s.current_stock<=0?{text:"Sem Estoque",color:"bg-red-100 text-red-800"}:s.is_low_stock?{text:"Estoque Baixo",color:"bg-yellow-100 text-yellow-800"}:{text:"Normal",color:"bg-green-100 text-green-800"};return e.jsxs(C,{header:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:s.name}),e.jsxs("p",{className:"mt-1 text-sm text-gray-600",children:["Ref: ",s.reference]})]}),e.jsxs("div",{className:"flex space-x-3",children:[b()&&e.jsx("button",{onClick:()=>n(!x),className:"bg-indigo-600 hover:bg-indigo-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Ajustar Estoque"}),v()&&e.jsx(a,{href:route("admin.inventory.create",{material_id:s.id}),className:"bg-green-600 hover:bg-green-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Nova Transação"}),f()&&e.jsx(a,{href:route("admin.materials.edit",s.id),className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg transition-colors",children:"Editar Material"}),e.jsx(a,{href:route("admin.materials.index"),className:"bg-gray-500 hover:bg-gray-600 text-white px-4 py-2 rounded-lg transition-colors",children:"Voltar"})]})]}),children:[e.jsx(E,{title:`Material - ${s.name}`}),e.jsx("div",{className:"py-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Informações do Material"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Detalhes completos sobre o material."})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsxs("dl",{children:[e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Referência"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 font-mono",children:s.reference})]}),e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Nome"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:s.name})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Unidade de Medida"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:s.unit})]}),e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Preço de Compra"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2 font-semibold",children:w(s.purchase_price)})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Estoque Atual"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"font-semibold",children:p(s.current_stock,s.unit)}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${u.color}`,children:u.text})]})})]}),e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Estoque Mínimo"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:p(s.minimum_stock,s.unit)})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Fornecedor Principal"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:s.supplier?e.jsx(a,{href:route("admin.suppliers.show",s.supplier.id),className:"text-purple-600 hover:text-purple-900",children:s.supplier.name}):e.jsx("span",{className:"text-gray-500",children:"Não definido"})})]}),s.secondary_supplier&&e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Fornecedor Secundário"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx(a,{href:route("admin.suppliers.show",s.secondary_supplier.id),className:"text-purple-600 hover:text-purple-900",children:s.secondary_supplier.name})})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Prazo de Entrega"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:[s.lead_time_days," dias"]})]}),e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Múltiplo de Compra"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:s.purchase_multiple})]}),s.weight_per_unit&&e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Peso/Volume por Unidade"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:s.weight_per_unit})]}),e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${s.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:s.is_active?"Ativo":"Inativo"})})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Criado em"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:new Date(s.created_at).toLocaleDateString("pt-BR")})]}),e.jsxs("div",{className:"bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6",children:[e.jsx("dt",{className:"text-sm font-medium text-gray-500",children:"Última atualização"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 sm:mt-0 sm:col-span-2",children:new Date(s.updated_at).toLocaleDateString("pt-BR")})]})]})})]}),x&&e.jsxs("div",{className:"mt-6 bg-white shadow rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Ajuste Rápido de Estoque"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Faça um ajuste rápido no estoque atual do material."})]}),e.jsxs("form",{onSubmit:N,className:"border-t border-gray-200 p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tipo de Transação"}),e.jsxs("select",{value:d.type,onChange:t=>l("type",t.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",required:!0,children:[e.jsx("option",{value:"purchase",children:"Compra"}),e.jsx("option",{value:"consumption",children:"Consumo"}),e.jsx("option",{value:"adjustment",children:"Ajuste Manual"}),e.jsx("option",{value:"return",children:"Devolução"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantidade"}),e.jsx("input",{type:"number",step:"0.001",value:d.quantity,onChange:t=>l("quantity",t.target.value),className:`w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500 ${c.quantity?"border-red-500":""}`,placeholder:"0.000",required:!0}),c.quantity&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:c.quantity})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Referência"}),e.jsx("input",{type:"text",value:d.reference,onChange:t=>l("reference",t.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"Ex: NF 12345, Ajuste Inventário"})]}),d.type==="purchase"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custo Unitário (R$)"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:d.unit_cost,onChange:t=>l("unit_cost",t.target.value),className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"0.00"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:d.notes,onChange:t=>l("notes",t.target.value),rows:3,className:"w-full rounded-lg border-gray-300 focus:border-purple-500 focus:ring-purple-500",placeholder:"Detalhes sobre o ajuste..."})]}),e.jsxs("div",{className:"flex justify-end space-x-4 mt-6",children:[e.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:o,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors disabled:opacity-50",children:o?"Salvando...":"Ajustar Estoque"})]})]})]}),i&&i.data.length>0&&e.jsxs("div",{className:"mt-6 bg-white shadow overflow-hidden sm:rounded-lg",children:[e.jsxs("div",{className:"px-4 py-5 sm:px-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Histórico de Transações"}),e.jsx("p",{className:"mt-1 max-w-2xl text-sm text-gray-500",children:"Últimas movimentações de estoque deste material."})]}),e.jsx(a,{href:route("admin.inventory.index",{material_id:s.id}),className:"text-purple-600 hover:text-purple-900 text-sm font-medium",children:"Ver Todas →"})]}),e.jsx("div",{className:"border-t border-gray-200",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantidade"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Usuário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Referência"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.data.map(t=>{var r;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:new Date(t.created_at).toLocaleString("pt-BR")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${t.type==="purchase"?"bg-green-100 text-green-800":t.type==="consumption"?"bg-red-100 text-red-800":t.type==="adjustment"?"bg-blue-100 text-blue-800":"bg-yellow-100 text-yellow-800"}`,children:t.type_display})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`text-sm font-medium ${t.quantity>=0?"text-green-600":"text-red-600"}`,children:[(t.quantity>=0?"+":"")+Number(t.quantity).toLocaleString("pt-BR",{minimumFractionDigits:3})," ",s.unit]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:((r=t.user)==null?void 0:r.name)||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t.reference||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsx(a,{href:route("admin.inventory.show",t.id),className:"text-purple-600 hover:text-purple-900",children:"Ver"})})]},t.id)})})]})})]})]})})]})}export{M as default};
